(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{395:function(e,t,o){var content=o(426);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(22).default)("ed646f92",content,!0,{sourceMap:!1})},425:function(e,t,o){"use strict";var n=o(395);o.n(n).a},426:function(e,t,o){(e.exports=o(21)(!1)).push([e.i,".btn-coupon[data-v-544339f2]{width:100px;height:40px}.btn-no-shadow[data-v-544339f2]{box-shadow:none}",""])},450:function(e,t,o){"use strict";o.r(t);o(55);var n={layout:"DashboardPage",name:"couponPage",data:function(){return{Show_modal:!1,coupon_type:null,coupon_title:"",ADD_coupon:{title:"",is_enabled:0,percent:0,due_date:"",code:""},edit_coupon:{}}},computed:{coupon_list:function(){var e=this.$store.state.coupon_list;return e.length>=1&&e}},methods:{coupon_modal:function(e,title,t){this.Show_modal=!0,this.coupon_type=e,this.coupon_title=title,"edit"===e&&(this.edit_coupon=Object.assign({},t))},Close_modal:function(){this.Show_modal=!1},TODO_coupon:function(e){var t=this;this.$validator.validate().then(function(o){if(o&&"new"===e){var n={data:t.ADD_coupon},time=new Date(t.ADD_coupon.due_date);t.ADD_coupon.due_date=time.getTime()/1e3,t.$store.dispatch("CREATE_coupon",n)}if(o&&"modify"===e){var r={data:t.edit_coupon,id:t.edit_coupon.id},c=new Date(t.edit_coupon.due_date);t.edit_coupon.due_date=c.getTime()/1e3,t.$store.dispatch("UPDATE_coupon",r)}}),this.Show_modal=!1},Delete_coupon:function(e){confirm("確定是否要刪除 ".concat(e.title))&&this.$store.dispatch("DELETE_coupon",e)}},filters:{date_format:function(e){if(e){var time=new Date(1e3*e),t=time.getFullYear(),o=time.getMonth()+1;o=("0"+o).substr(-2);var n=("0"+time.getDate()).substr(-2);return"".concat(t,"-").concat(o,"-").concat(n)}}},mounted:function(){this.$store.dispatch("GET_coupon")}},r=(o(425),o(6)),component=Object(r.a)(n,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"mt-2 d-flex justify-content-between align-items-center "},[o("h1",{staticClass:"my-2"},[e._v("優惠卷列表")]),e._v(" "),o("button",{staticClass:"btn btn-info btn-coupon",on:{click:function(t){return e.coupon_modal("add","新增優惠卷")}}},[e._v("新增優惠卷")])]),e._v(" "),o("div",{staticClass:"table-responsive-xl"},[o("table",{staticClass:"table table-hover"},[e._m(0),e._v(" "),o("tbody",e._l(e.coupon_list,function(t){return o("tr",{key:t.title},[o("th",{attrs:{scope:"row"}},[e._v(e._s(t.title))]),e._v(" "),o("td",[e._v(e._s(t.code))]),e._v(" "),o("td",[e._v(e._s(t.percent)+"%")]),e._v(" "),o("td",[e._v(e._s(t.is_enabled?"啟用":"未啟用"))]),e._v(" "),o("td",[e._v(e._s(e._f("date_format")(t.due_date)))]),e._v(" "),o("td",[o("button",{staticClass:"btn btn-outline-info",attrs:{type:"button"},on:{click:function(o){return e.coupon_modal("edit","編輯優惠卷",t)}}},[e._v("編輯")])]),e._v(" "),o("td",[o("button",{staticClass:"btn btn-outline-danger",attrs:{type:"button"},on:{click:function(o){return e.Delete_coupon(t)}}},[e._v("刪除")])])])}),0)])]),e._v(" "),o("b-modal",{ref:"coupon-modal",attrs:{title:e.coupon_title,"hide-footer":""},model:{value:e.Show_modal,callback:function(t){e.Show_modal=t},expression:"Show_modal"}},["add"===e.coupon_type?o("div",[o("form",{staticClass:"cart-billing-info",on:{submit:function(t){return t.preventDefault(),e.TODO_coupon("new")}}},[o("label",{staticClass:"mb-2 d-block",attrs:{for:"coupon-name"}},[e._v("coupon名稱")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.ADD_coupon.title,expression:"ADD_coupon.title"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("name")},attrs:{type:"text",id:"coupon-name",name:"name"},domProps:{value:e.ADD_coupon.title},on:{input:function(t){t.target.composing||e.$set(e.ADD_coupon,"title",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("name"),expression:"errors.has('name')"}],staticClass:"text-danger"},[e._v("名稱必須填寫")]),e._v(" "),o("label",{staticClass:"mb-2 d-block",attrs:{for:"code"}},[e._v("折扣碼")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.ADD_coupon.code,expression:"ADD_coupon.code"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("code")},attrs:{type:"text",id:"coupon-code",name:"code"},domProps:{value:e.ADD_coupon.code},on:{input:function(t){t.target.composing||e.$set(e.ADD_coupon,"code",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("code"),expression:"errors.has('code')"}],staticClass:"text-danger"},[e._v("折扣碼必須填寫")]),e._v(" "),o("label",{staticClass:"mb-2 d-block",attrs:{for:"user-percent"}},[e._v("折扣數")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.ADD_coupon.percent,expression:"ADD_coupon.percent"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("percent")},attrs:{type:"number",id:"coupon-percent",name:"percent"},domProps:{value:e.ADD_coupon.percent},on:{input:function(t){t.target.composing||e.$set(e.ADD_coupon,"percent",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("percent"),expression:"errors.has('percent')"}],staticClass:"text-danger"},[e._v("折扣數必須填寫")]),e._v(" "),o("label",{staticClass:"mb-2 d-block",attrs:{for:"ucoupone-time"}},[e._v("coupon到期日")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.ADD_coupon.due_date,expression:"ADD_coupon.due_date"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("time")},attrs:{type:"text",id:"coupone-time",name:"time",placeholder:"2019,10,10"},domProps:{value:e.ADD_coupon.due_date},on:{input:function(t){t.target.composing||e.$set(e.ADD_coupon,"due_date",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("time"),expression:"errors.has('time')"}],staticClass:"text-danger"},[e._v("到期日必須填寫")]),e._v(" "),o("br"),e._v(" "),o("label",{staticClass:"mb-2 mr-2",attrs:{for:"copone-enabled"}},[e._v("是否開啟")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.ADD_coupon.is_enabled,expression:"ADD_coupon.is_enabled"}],staticClass:"btn-no-shadow",attrs:{id:"copone-enabled",type:"checkbox","true-value":1,"false-value":0},domProps:{checked:Array.isArray(e.ADD_coupon.is_enabled)?e._i(e.ADD_coupon.is_enabled,null)>-1:e._q(e.ADD_coupon.is_enabled,1)},on:{change:function(t){var o=e.ADD_coupon.is_enabled,n=t.target,r=n.checked?1:0;if(Array.isArray(o)){var c=e._i(o,null);n.checked?c<0&&e.$set(e.ADD_coupon,"is_enabled",o.concat([null])):c>-1&&e.$set(e.ADD_coupon,"is_enabled",o.slice(0,c).concat(o.slice(c+1)))}else e.$set(e.ADD_coupon,"is_enabled",r)}}}),e._v(" "),o("br"),e._v(" "),o("div",{staticClass:"d-flex justify-content-end"},[o("button",{staticClass:"btn btn-secondary",on:{click:e.Close_modal}},[e._v("取消")]),e._v(" "),o("button",{staticClass:"btn btn-success ml-2",attrs:{type:"submit"}},[e._v("新增")])])])]):"edit"===e.coupon_type?o("div",[o("form",{staticClass:"cart-billing-info",on:{submit:function(t){return t.preventDefault(),e.TODO_coupon("modify")}}},[o("label",{staticClass:"mb-2 d-block",attrs:{for:"coupon-name"}},[e._v("coupon名稱")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.edit_coupon.title,expression:"edit_coupon.title"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("name")},attrs:{type:"text",id:"coupon-name",name:"name"},domProps:{value:e.edit_coupon.title},on:{input:function(t){t.target.composing||e.$set(e.edit_coupon,"title",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("name"),expression:"errors.has('name')"}],staticClass:"text-danger"},[e._v("名稱必須填寫")]),e._v(" "),o("label",{staticClass:"mb-2 d-block",attrs:{for:"code"}},[e._v("折扣碼")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.edit_coupon.code,expression:"edit_coupon.code"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("code")},attrs:{type:"text",id:"coupon-code",name:"code"},domProps:{value:e.edit_coupon.code},on:{input:function(t){t.target.composing||e.$set(e.edit_coupon,"code",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("code"),expression:"errors.has('code')"}],staticClass:"text-danger"},[e._v("折扣碼必須填寫")]),e._v(" "),o("label",{staticClass:"mb-2 d-block",attrs:{for:"user-percent"}},[e._v("折扣數")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.edit_coupon.percent,expression:"edit_coupon.percent"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("percent")},attrs:{type:"number",id:"coupon-percent",name:"percent"},domProps:{value:e.edit_coupon.percent},on:{input:function(t){t.target.composing||e.$set(e.edit_coupon,"percent",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("percent"),expression:"errors.has('percent')"}],staticClass:"text-danger"},[e._v("折扣數必須填寫")]),e._v(" "),o("label",{staticClass:"mb-2 d-block",attrs:{for:"ucoupone-time"}},[e._v("coupon到期日")]),e._v(" "),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.edit_coupon.due_date,expression:"edit_coupon.due_date"}],staticClass:"mb-3",class:{"is-invalid":e.errors.has("time")},attrs:{type:"text",id:"coupone-time",name:"time",placeholder:"2019,10,10"},domProps:{value:e.edit_coupon.due_date},on:{input:function(t){t.target.composing||e.$set(e.edit_coupon,"due_date",t.target.value)}}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("time"),expression:"errors.has('time')"}],staticClass:"text-danger"},[e._v("到期日必須填寫")]),e._v(" "),o("br"),e._v(" "),o("label",{staticClass:"mb-2 mr-2",attrs:{for:"copone-enabled"}},[e._v("是否開啟")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.edit_coupon.is_enabled,expression:"edit_coupon.is_enabled"}],staticClass:"btn-no-shadow",attrs:{id:"copone-enabled",type:"checkbox","true-value":1,"false-value":0},domProps:{checked:Array.isArray(e.edit_coupon.is_enabled)?e._i(e.edit_coupon.is_enabled,null)>-1:e._q(e.edit_coupon.is_enabled,1)},on:{change:function(t){var o=e.edit_coupon.is_enabled,n=t.target,r=n.checked?1:0;if(Array.isArray(o)){var c=e._i(o,null);n.checked?c<0&&e.$set(e.edit_coupon,"is_enabled",o.concat([null])):c>-1&&e.$set(e.edit_coupon,"is_enabled",o.slice(0,c).concat(o.slice(c+1)))}else e.$set(e.edit_coupon,"is_enabled",r)}}}),e._v(" "),o("br"),e._v(" "),o("div",{staticClass:"d-flex justify-content-end"},[o("button",{staticClass:"btn btn-secondary",on:{click:function(t){return e.Close_modal()}}},[e._v("取消")]),e._v(" "),o("button",{staticClass:"btn btn-success ml-2",attrs:{type:"submit"}},[e._v("修改")])])])]):e._e()])],1)},[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("thead",[o("tr",[o("th",[e._v("優惠卷名稱")]),e._v(" "),o("th",[e._v("折扣碼")]),e._v(" "),o("th",[e._v("折扣數")]),e._v(" "),o("th",[e._v("啟用")]),e._v(" "),o("th",[e._v("到期日")]),e._v(" "),o("th",[e._v("編輯")]),e._v(" "),o("th",[e._v("刪除")])])])}],!1,null,"544339f2",null);t.default=component.exports}}]);